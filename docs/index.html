<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 6.3.2" />
    <title>index</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20width%3D%2256.243pt%22%20height%3D%2254.884pt%22%20viewBox%3D%220%200%2056.243%2054.884%22%20version%3D%221.1%22%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip1%22%3E%0A%20%20%3Cpath%20d%3D%22M%200%200%20L%2056.242188%200%20L%2056.242188%2054.882812%20L%200%2054.882812%20Z%20M%200%200%20%22/%3E%0A%3C/clipPath%3E%0A%3C/defs%3E%0A%3Cg%20id%3D%22surface1%22%3E%0A%3Cg%20clip-path%3D%22url%28%23clip1%29%22%20clip-rule%3D%22nonzero%22%3E%0A%3Cpath%20style%3D%22fill-rule%3Aevenodd%3Bfill%3Argb%280%25%2C0%25%2C0%25%29%3Bfill-opacity%3A1%3Bstroke-width%3A0.4%3Bstroke-linecap%3Abutt%3Bstroke-linejoin%3Around%3Bstroke%3Argb%280%25%2C0%25%2C0%25%29%3Bstroke-opacity%3A1%3Bstroke-miterlimit%3A10%3B%22%20d%3D%22M%20261.863719%20697.864063%20C%20266.090281%20696.575%20270.559031%20698.957813%20271.848094%20703.184375%20C%20273.137156%20707.410938%20270.754344%20711.879688%20266.527781%20713.16875%20C%20262.301219%20714.457813%20257.832469%20712.075%20256.543406%20707.848438%20C%20255.254344%20703.621875%20257.637156%20699.153125%20261.863719%20697.864063%20M%20280.973094%20698.996875%20L%20288.398875%20691.297656%20L%20283.219187%20684.754688%20L%20274.38325%20690.676563%20L%20269.559031%20688.332813%20L%20268.371531%20677.54375%20L%20260.023875%20677.516406%20L%20258.949656%20688.297656%20L%20254.105906%20690.610156%20L%20245.129344%20684.629688%20L%20239.902781%20691.1375%20L%20247.461375%20698.883594%20L%20246.250438%20704.110156%20L%20236.176219%20707.219531%20L%20238.00825%20715.360156%20L%20248.578563%20714.465625%20L%20251.910594%20718.672656%20L%20248.25825%20728.301563%20L%20255.762156%20731.946094%20L%20261.453562%20723.305469%20L%20266.82075%20723.325%20L%20272.269969%20732.000781%20L%20279.801219%20728.403125%20L%20276.394969%20718.750781%20L%20279.754344%20714.567188%20L%20290.137156%20715.532031%20L%20292.019969%20707.403125%20L%20282.148875%20704.23125%20Z%20M%20280.973094%20698.996875%20%22%20transform%3D%22matrix%281%2C0%2C0%2C-1%2C-235.977%2C732.2%29%22/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E"/>


<style type="text/css">/*! * Bootstrap Reboot v5.0.0-beta1 (https://getbootstrap.com/) * Copyright 2011-2020 The Bootstrap Authors * Copyright 2011-2020 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}[tabindex="-1"]:focus:not(:focus-visible){outline:0!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus{outline:dotted 1px;outline:-webkit-focus-ring-color auto 5px}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style type="text/css">/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style type="text/css">/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main{padding:2rem 3vw;}.git-button{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}  html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3, .pdoc h4{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}  .pdoc .attribution{  transform:scale(0.75); }}</style>
</head>
<body>  <nav class="pdoc">
    <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
    <input id="togglestate" type="checkbox">
    <div style="height: 80%">

        <h3>Contents</h3>
        <ul>
  <li><a href="#basic-concepts">Basic Concepts</a></li>
  <li><a href="#usage">Usage</a>
  <ul>
    <li><a href="#generate-argument-combinations">Generate Argument Combinations</a></li>
    <li><a href="#everything-is-a-blob">Everything is a Blob</a></li>
    <li><a href="#skip-unnecessary-runs">Skip Unnecessary Runs</a></li>
    <li><a href="#postprocessing-the-output">Postprocessing the Output</a></li>
  </ul></li>
  <li><a href="#details">Details</a>
  <ul>
    <li><a href="#blobs">Blobs</a></li>
    <li><a href="#filtering-the-combinations">Filtering the Combinations</a></li>
    <li><a href="#policy-of-skipping-runs">Policy of Skipping Runs</a></li>
    <li><a href="#headers">Headers</a></li>
    <li><a href="#error-handling">Error Handling</a></li>
  </ul></li>
  <li><a href="#miscellaneous-features">Miscellaneous Features</a>
  <ul>
    <li><a href="#experiment-names-and-groups">Experiment Names and Groups</a></li>
    <li><a href="#parallelization">Parallelization</a></li>
    <li><a href="#dry-run">Dry Run</a></li>
    <li><a href="#creating-directories">Creating Directories</a></li>
    <li><a href="#multiple-runs-in-one-script">Multiple Runs in One Script</a></li>
    <li><a href="#section-headlines">Section Headlines</a></li>
  </ul></li>
  <li><a href="#interface-documentationrunhtml"><a href="./run.html">Interface Documentation</a></a></li>
</ul>



	<a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
          built with <span class="visually-hidden">pdoc</span><img
          alt="pdoc logo"
          src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
	</a>
    </div>
  </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
      run
    </h1>

                        <div class="docstring"><p>A module for running experiments that involve the execution of
commands with different combinations of command line arguments.</p>

<p>Read on for an explanation with a bunch of examples, check out the
<a href="./run.html">reference documentation</a>, or download the
<a href="https://github.com/thobl/run">code</a>.</p>

<h1 id="basic-concepts">Basic Concepts</h1>

<ol>
<li><p><strong>Generate Argument Combinations.</strong> Instead of specifying all
combinations of command line arguments for your experiment
explicitly, you specify the sets of values for each argument.  A
set of runs with one run for each combination is generated
automatically.</p></li>
<li><p><strong>Everything is a Blob.</strong> At its core a blob is something that
evaluates to a string based on the arguments of a single run.  In
most cases, a blob is simply a string that can contain wildcards
for these arguments.</p></li>
<li><p><strong>Skip Unnecessary Runs.</strong> Runs are skipped if the produced output
file already exists.  This is particularly helpful if the
experiment setup evolves over time.</p></li>
<li><p><strong>Postprocessing the Output.</strong> If the command prints its result to
<code>stdout</code>, you can specify how it should be saved to a file.  This
lets you, e.g., add some reformatting procedure or handle timeouts.</p></li>
</ol>

<h1 id="usage">Usage</h1>

<p>Your experiment script should look somewhat like this:</p>

<div class="codehilite"><pre><span></span><code><span class="c1"># example.py</span>
<span class="kn">import</span> <span class="nn">run</span>

<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">run</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p>The method <code><a href="run.html#add">run.add()</a></code> has three mandatory parameters and multiple
keyword parameters.  The first parameter specifies the name of the
experiment.  This is used so you can select which experiments to run,
e.g., calling <code>python example.py name1 name2</code> runs all experiments
where the name was <code>name1</code> or <code>name2</code> (experiments can also be
<a href="#experiment-names-and-groups">grouped</a>).  The second parameter
specifies the command that should be called and the third parameter is
a description of the arguments the command should be called with.
Their usage is explained in the <a href="#generate-argument-combinations">next
section</a>.</p>

<h2 id="generate-argument-combinations">Generate Argument Combinations</h2>

<p>Here is an easy example for an experiment that create some files by
calling the <code>touch</code> command.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;create_files&quot;</span><span class="p">,</span>
    <span class="s2">&quot;touch output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<p>The third parameter specifies the three arguments <code>a</code>, <code>b</code>, and
<code>c</code>.  As <code>a</code> and <code>b</code> are lists, one run is created for each
combination of arguments.  The second parameter specifies the command
for each run.  It is a blob, i.e., the wildcard of the form <code>[[a]]</code>
is replaced with the corresponding value for <code>a</code> in each of the
runs.  Thus, the above experiment calls <code>touch</code> six times creating
the following files.</p>

<div class="codehilite"><pre><span></span><code>$ ls output/
<span class="s1">&#39;a=1_b=1_c=0.txt&#39;</span>  <span class="s1">&#39;a=1_b=2_c=0.txt&#39;</span>  <span class="s1">&#39;a=1_b=3_c=0.txt&#39;</span>
<span class="s1">&#39;a=2_b=1_c=0.txt&#39;</span>  <span class="s1">&#39;a=2_b=2_c=0.txt&#39;</span>  <span class="s1">&#39;a=2_b=3_c=0.txt&#39;</span>
</code></pre></div>

<p><strong>Note:</strong> In case your experiment involves some dependencies between
the parameters that make some of the combinations invalid, you can
<a href="#filtering-the-combinations">filter those out</a>.</p>

<h2 id="everything-is-a-blob">Everything is a Blob</h2>

<p>In the above example, the command (second parameter) is a blob, i.e.,
all wildcards are replaced with the appropriate values for each run.
Besides being a string with wildcards, a blob can also be a function
that returns a string with wildcards.  In this case, it is called with
the arguments of the current run as parameter, before the wildcards
are replaced.  See <a href="#blobs">Blobs</a> for more details.</p>

<p>Almost all parameters of <code><a href="run.html#add">run.add()</a></code> are blobs and are thus evaluated
based on the arguments of each individual run.  Even the arguments
themselves can be blobs based on earlier arguments.  The <a href="#skip-unnecessary-runs">next
section</a> contains an example for this.
Moreover, there are some more details on blobs <a href="#blobs">below</a>.</p>

<h2 id="skip-unnecessary-runs">Skip Unnecessary Runs</h2>

<p>In the above example, <code><a href="run.html">run</a></code> does not know that the runs create
files.  Thus, the <code>touch</code> commands is called even if the files
already exist.  You can use the optimal parameter <code>creates_file</code> to
explicitly state which file is created by a run.  It is a blob, so in
the above example you could add
<code>creats_file="output/a=[[a]]_b=[[b]]_c=[[c]].txt"</code>.  Equivalently,
you can achieve the same in the following more elegant way, using that
the arguments themselves are blobs.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;create_files&quot;</span><span class="p">,</span>
    <span class="s2">&quot;touch [[file]]&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s2">&quot;output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;</span><span class="p">},</span>
    <span class="n">creates_file</span><span class="o">=</span><span class="s2">&quot;[[file]]&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>Now executing the script calls <code>touch</code> only for those files that do
not already exist.  For more details on when exactly a run is skipped,
see <a href="#policy-of-skipping-runs">Policy of Skipping Runs</a>.</p>

<p><strong>Note:</strong> Specifying <code>creates_file</code> is only necessary if the command
itself creates the file.  If instead the command's output to <code>stdout</code>
is written to a file (see <a href="#postprocessing-the-output">next section</a>),
<code><a href="run.html">run</a></code> already knows which file is created.</p>

<h2 id="postprocessing-the-output">Postprocessing the Output</h2>

<p>If the parameter <code>stdout_file</code> is provided, the command's output to
<code>stdout</code> is written to the corresponding file.  This is illustrated
by the following example.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo $(([[a]] + [[b]]))&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output/[[a]]+[[b]].txt&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>The <code>echo</code> command itself adds the two given values and writes them
to standard output.  The run module takes this result and writes it
to the provided file instead.  Thus, executing this example creates
six files with different values for a and b, each of which contains
the sum of a and b as content.</p>

<p>You can postprocess <code>stdout</code> (given as string) by providing the
parameters <code>stdout_mod</code> (a function returning a blob) or
<code>stdout_res</code> (a blob).  If both are provided, they are applied in
this order.</p>

<p>The function <code>stdout_mod</code> gets <code>stdout</code> as input its return value
replaces <code>stdout</code>.  This can serve as some kind of parser that,
e.g., reformats the output from something human readable to csv.
Additionally, if the function takes two parameters, the second
parameter is the result of the call to
<a href="https://docs.python.org/3/library/subprocess.html#subprocess.run"><code>subprocess.run()</code></a>.
This can be useful to do a more sophisticated reformatting not only
based on <code>stdout</code> but also, e.g., on the return code or stderr.</p>

<p>If the blob <code>stdout_res</code> is given, this blob is written to the file
instead of <code>stdout</code> itself.  This blob is somewhat special as it
allows for the additional argument <code>stdout</code>.  The following example
uses <code>stdout_res</code> with the wildcard <code>[[stdout]]</code>.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo $(([[a]] + [[b]]))&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output/sums.txt&quot;</span><span class="p">,</span>
    <span class="n">stdout_res</span><span class="o">=</span><span class="s2">&quot;[[a]] + [[b]] = [[stdout]]&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>This produces the following file.</p>

<div class="codehilite"><pre><span></span><code>$ cat output/sums.txt 
<span class="m">2</span> + <span class="nv">3</span> <span class="o">=</span> <span class="m">5</span>
<span class="m">2</span> + <span class="nv">4</span> <span class="o">=</span> <span class="m">6</span>
<span class="m">1</span> + <span class="nv">3</span> <span class="o">=</span> <span class="m">4</span>
<span class="m">1</span> + <span class="nv">4</span> <span class="o">=</span> <span class="m">5</span>
</code></pre></div>

<p>Note that the output of the individual runs was appended to the file,
i.e., the runs were not skipped.  This is the intended behavior to
support these kind of experiment setups; see <a href="#policy-of-skipping-runs">Policy of Skipping
Runs</a> for more details on when exactly a run
is skipped.</p>

<p><strong>Note:</strong> There are several cases where <code>stdout_mod</code> and
<code>stdout_res</code> can both be used to achieve the same thing.  You can
use this rule of thumb:</p>

<ul>
<li><p>Use <code>stdout_mod</code> if you want to reformat <code>stdout</code> or if you
need access to things like the return code.</p></li>
<li><p>Use <code>stdout_res</code> if you want to combine <code>stdout</code> with the input
arguments.</p></li>
<li><p>Use both if you need both.</p></li>
</ul>

<p><strong>Note:</strong> When using <code>stdout_file</code>, one can additionally <a href="#headers">write a
header</a> to the first line of the file.</p>

<h1 id="details">Details</h1>

<p>When you execute your experiment script, the following steps are
performed in this order.</p>

<ol>
<li><p><strong>Generate Combinations.</strong> For each experiment, create the cross
product of all argument lists provided in third parameter of
<code><a href="run.html#add">run.add()</a></code>.  For each argument combination that is not rejected
by <a href="#filtering-the-combinations"><code>combinations_filter</code></a>, a single
run is created.  Each individual argument is a blob.</p></li>
<li><p><strong>Deblob.</strong> For each individual run, the <a href="#blobs">blobs are turned into
strings</a>.  This is first done for all arguments in the
order they are given.  Then all other blobs (except <code>stdout_res</code>)
are deblobbed.</p></li>
<li><p><strong>Skipping Runs.</strong> For each run, it is decided whether to skip the
run.  A run is skipped if the file it would produce (specified by
<code>creates_file</code> or <code>stdout_file</code>) already exists at this stage
in the process.</p></li>
<li><p><strong>Filter Unselected Runs.</strong> A run counts as selected if its
experiments <a href="#experiment-names-and-groups">name or group</a> was used
as command line parameter to execute your experiment script.  All
other runs are ignored.</p></li>
<li><p><strong>Run and Output Results.</strong> The runs are executed and, depending on
the <a href="#postprocessing-the-output">stdout settings</a> and the <a href="#headers">header
settings</a>, the output is written.</p></li>
</ol>

<h2 id="blobs">Blobs</h2>

<p>Deblobbing happens in three steps in the function <code><a href="run.html#deblob">run.deblob()</a></code>.</p>

<ol>
<li><p>If the blob is a function, it is called with one parameter
<code>args</code>.  <code>args</code> is a dictionary mapping from the argument names
to the value.  Note that this is done after generating the
combinations, i.e., the argument values are no longer lists.</p></li>
<li><p>The result of step 1. (or the blob itself if it is not a function)
is converted into a string.  Thus, it is ok for an argument to
have, e.g., integer values or for the above function to return
integer values.</p></li>
<li><p>In the resulting string, each pattern of the form <code>[[key]]</code> is
replaced with the corresponding value in <code>args</code>.</p></li>
</ol>

<p>The following example is similar to one of the previous examples,
extending the computation of the sum to also compute differences,
products, and quotients.  It gives an example of how to make use of
the fact that blobs can be functions.  Note how the output file name
(<code>stdout_file</code>) of each run depends on the operator.  As the
argument combinations are generated before deblobbing,
<code>args['operator']</code> in the lambda function evaluates to one of the
operators (and not to the list of all operators).  Running this,
creates the four files <code>sum.txt</code>, <code>diff.txt</code>, <code>prod.txt</code>, and
<code>quot.txt</code>, each containing the respective calculations.</p>

<div class="codehilite"><pre><span></span><code><span class="n">res_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;+&#39;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="s2">&quot;diff&quot;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="s2">&quot;prod&quot;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span> <span class="s2">&quot;quot&quot;</span><span class="p">}</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;calculate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo $(([[a]] [[operator]] [[b]]))&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
     <span class="s1">&#39;operator&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">]</span>
     <span class="p">},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="s2">&quot;output/&quot;</span> <span class="o">+</span> <span class="n">res_name</span><span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;operator&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span>
    <span class="n">stdout_res</span><span class="o">=</span><span class="s2">&quot;[[a]] [[operator]] [[b]] = [[stdout]]&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>The next example highlights how the order of evaluation matters when
using blobs for the arguments.  Assume we have three arguments <code>a</code>,
<code>b</code>, and <code>c</code> that depend on each other, i.e., we want to consider
not all but only certain combinations of values.  In this example, we
want <code>a</code>, <code>b</code>, and <code>c</code> to be all combinations of natural numbers
with <code>a + b + c = 4</code>.  In the example below, this is done using the
helper argument <code>triple</code>, which is a list of triples.  Then the
actual arguments <code>a</code>, <code>b</code>, and <code>c</code> use these triples.  Note that
blobs of <code>a</code>, <code>b</code>, and <code>c</code> are deblobbed (i.e., their lambda
functions are called) after lists have been split into separate runs
but before the <code>triple</code> argument was deblobbed.  Thus,
<code>args['triple']</code> is a dictionary of the form <code>{'a': a, 'b': b, 'c':
c}</code>.  Moreover, <code>a</code>, <code>b</code>, and <code>c</code> are deblobbed before
<code>file</code>, which makes them usable as wildcards.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;sum_of_squares&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo $(([[a]] * [[a]] + [[b]] * [[b]] + [[c]] * [[c]]))&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;triple&#39;</span><span class="p">][</span><span class="s1">&#39;a&#39;</span><span class="p">],</span>
     <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;triple&#39;</span><span class="p">][</span><span class="s1">&#39;b&#39;</span><span class="p">],</span>
     <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;triple&#39;</span><span class="p">][</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
     <span class="s1">&#39;triple&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">4</span><span class="p">],</span>
     <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s2">&quot;output/sum_of_squares_[[a]]_[[b]]_[[c]].txt&quot;</span>
     <span class="p">},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;[[file]]&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>Changing the order could have unwanted effects.  Moving the argument
<code>triple</code> before <code>a</code> would first deblob <code>triple</code>, before calling
the lambda function, which means that <code>args['triple']</code> would be the
string representation of the dictionary instead of the dictionary
itself.  Moreover, having <code>file</code> before <code>a</code> would make the use of
<code>'[[a]]'</code> invalid, as the argument <code>a</code> would not be a string but a
function when trying to do the replacement.</p>

<p>As a rule of thumb: Arguments you use as wild cards should go before,
arguments you want to use in their original form (not in their string
representation) within a function should go after.</p>

<p><strong>Note:</strong> In the above example one could of course remove the <code>file</code>
argument and directly assign its blob to <code>stdout_file</code>, as the
arguments are always deblobbed before any other blobs (like
<code>stdout_file</code>).</p>

<h2 id="filtering-the-combinations">Filtering the Combinations</h2>

<p>The previous example showed a somewhat hacky way of only looking at
those combinations of arguments <code>a</code>, <code>b</code>, and <code>c</code> where <code>a +
b + c = 4</code>.  This can be achieved much easier using the parameter
<code>combinations_filter</code>.  It is a function that gets called for every
argument combination and decides whether it is valid (in which case a
run is created) or not (in which case the combination is discarded).</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;better_sum_of_squares&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo $(([[a]] * [[a]] + [[b]] * [[b]] + [[c]] * [[c]]))&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output/sum_of_squares_[[a]]_[[b]]_[[c]]_good.txt&quot;</span><span class="p">,</span>
    <span class="n">combinations_filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="policy-of-skipping-runs">Policy of Skipping Runs</h2>

<p>From the <a href="#details">order of steps</a> discussed above, it becomes
implicitly clear that runs are only skipped if the result files
already exist at the time the script is executed.  Thus, if two runs
have the same non-existent output file, they are both run, even if the
file exists when the second run starts.  To make this more explicit,
here is the behavior of writing files when using the <code>stdout_file</code>
parameter.</p>

<ol>
<li><p>If the file exists when adding the experiment via <code><a href="run.html#add">run.add()</a></code>
(i.e., before running any experiment), then the run is skipped.</p></li>
<li><p>If the run is not skipped but the file exists when executing the
run, <code>stdout</code> is added at the end of the file.</p></li>
<li><p>If the file does not exist, it is created beginning with the
<a href="#headers">header</a> (if specified) and then <code>stdout</code> is added.</p></li>
</ol>

<p>Thus, instead of writing one file per run, one can also have multiple
runs write their output into a single file.  This can be the intended
behavior if, e.g., the output of the same algorithm on multiple
instances should appear in the same csv file.  The disadvantage of
this is that either all or none of the experiments creating this file
are skipped, so extending the experiment would require to rerun it
(which might be ok, depending on your use case).</p>

<h2 id="headers">Headers</h2>

<p>When using <code>stdout_file</code>, one can use the parameter
<code>header_string</code> (a blob) to specify a header that should appear in
the first line of the file.  Alternatively, one can specify
<code>header_command</code> (again, a blob), which is a command that is
executed and its output (to <code>stdout</code>) is used as header.  The
resulting header can be modified by specifying the parameter
<code>header_mod</code>.  It should be a function that takes the unmodified
header as input and outputs the actual (modified) header.</p>

<p>Using <code>header_command</code> instead of simply <code>header_string</code> is
advantageous in the following scenario.  Assume you have an executable
called <code>algo</code> that runs a certain algorithm on an input file and
outputs some statistics using comma-separated values.  Moreover,
assume <code>algo</code> is capable of printing the corresponding header by
calling <code>algo --only-header</code>.  Then the following example first
writes the header (obtained by calling <code>algo --only-header</code>)
followed by the results of running <code>algo</code> on three input files.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;algo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;algo [[input]]&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;file1&quot;</span><span class="p">,</span> <span class="s2">&quot;file2&quot;</span><span class="p">,</span> <span class="s2">&quot;file3&quot;</span><span class="p">]},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output.csv&quot;</span><span class="p">,</span>
    <span class="n">header_command</span><span class="o">=</span><span class="s2">&quot;algo --only-header&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>The advantage of this is that the knowledge about the output of
<code>algo</code> is concentrated at the <code>algo</code> executable, i.e., the
experiment script does not have to change if the statistics printed by
<code>algo</code> change.  Moreover, using <code>header_command</code> over
<code>header_string</code> becomes even more advantageous, when running
multiple commands, e.g., <code>algo1</code> and <code>algo2</code>, with the same
command line interface (but potentially very different outputs) on the
same set of files.  This is illustrated by the following example (note
the usage of the wildcard <code>[[algo]]</code> in the command (second
parameter) and the <code>header_command</code>).</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;algos&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[[algo]] [[input]]&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;algo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;algo1&quot;</span><span class="p">,</span> <span class="s2">&quot;algo2&quot;</span><span class="p">],</span>
     <span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;file1&quot;</span><span class="p">,</span> <span class="s2">&quot;file2&quot;</span><span class="p">,</span> <span class="s2">&quot;file3&quot;</span><span class="p">]},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output_[[algo]].csv&quot;</span><span class="p">,</span>
    <span class="n">header_command</span><span class="o">=</span><span class="s2">&quot;[[algo]] --only-header&quot;</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="error-handling">Error Handling</h2>

<p>This section is only about errors that happen when executing a run.
If you have an error in your experiment specification, then you
probably just get a python error you have to deal with.</p>

<p>You can specify the allowed return codes of an experiment via the
parameter <code>allowed_return_codes</code>.  The default is <code>[0]</code>.  If the
return code of the command is not in the list of allowed return codes,
a warning is printed and the run is aborted, meaning that <code>stdout</code>
is <strong>not</strong> written to the file given by <code>stdout_file</code>.  You can set
<code>allowed_return_codes</code> to <code>[]</code> to indicate that every return code
should be accepted (you probably should not do this).</p>

<p>In case different return codes are possible, you probably want to
postprocess the result by using <code>stdout_mod</code> or <code>stdout_res</code>.
With the former, you have access to the return code; with the latter
you only have the output of the command; see the section about
<a href="#postprocessing-the-output">postprocessing the standard output</a>.</p>

<p>In the following example, <code>sleep [[time]] &amp;&amp; echo waking up</code> waits
for 0 to 4 seconds and then outputs <code>waking up</code>.  The command
<code>timeout 2</code> aborts this after 2 seconds and returns with code
<code>124</code> and no output to <code>stdout</code>.  The return codes <code>0</code> and
<code>124</code> are allowed by setting <code>allowed_return_codes=[0, 124]</code>.
Moreover, the blob <code>stdout_res</code> specifies the output depending on
whether there was a timeout.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;timeouts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeout 2 sleep [[time]] &amp;&amp; echo waking up&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output/timeouts.txt&quot;</span><span class="p">,</span>
    <span class="n">allowed_return_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">124</span><span class="p">],</span>
    <span class="n">stdout_res</span><span class="o">=</span><span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;sleeping [[time]]s -&gt; [[stdout]]&quot;</span> <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;stdout&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span>
        <span class="s2">&quot;sleeping [[time]]s -&gt; timeout&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

<p>This produces the following file.</p>

<div class="codehilite"><pre><span></span><code>$ cat output/timeouts.txt 
sleeping 0s -&gt; waking up
sleeping 1s -&gt; waking up
sleeping 3s -&gt; timeout
sleeping 4s -&gt; timeout
sleeping 2s -&gt; timeout
</code></pre></div>

<p>The above example relies on the fact that the standard output is the
empty string in case of an error.  The following yields the same
result but explicitly checks for the return code using <code>stdout_mod</code>
instead of <code>stdout_res</code>.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;timeouts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeout 2 sleep [[time]] &amp;&amp; echo waking up&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output/timeouts.txt&quot;</span><span class="p">,</span>
    <span class="n">allowed_return_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">124</span><span class="p">],</span>
    <span class="n">stdout_mod</span><span class="o">=</span><span class="k">lambda</span> <span class="n">out</span><span class="p">,</span> <span class="n">res</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;sleeping [[time]]s -&gt; [[stdout]]&quot;</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">else</span> <span class="s2">&quot;sleeping [[time]]s -&gt; timeout&quot;</span>
    <span class="p">),</span>
<span class="p">)</span>
</code></pre></div>

<p>In the above example, one could also use the parameter <code>out</code>
directly instead of using the wildcard <code>[[stdout]]</code>.</p>

<h1 id="miscellaneous-features">Miscellaneous Features</h1>

<p>There are some features that are not at the core of <code><a href="run.html">run</a></code> in the sense
that they are independent of how you specify your experiments.
Nonetheless they are pretty useful and should be mentioned here.</p>

<h2 id="experiment-names-and-groups">Experiment Names and Groups</h2>

<p>When running the experiment script with all examples from above by
calling <code>python example.py create_files calculate</code>, the output looks
somewhat like this:</p>

<p><img src="example_run_1.png" alt="Example Run 1" /></p>

<p>You can see that a bunch of experiments are available.  The two
selected ones are highlighted in green (here <code>create_files</code> and
<code>calculate</code>), all others are red.</p>

<p>To select which experiments to run more conveniently, you can group
experiments using the <code><a href="run.html#group">run.group()</a></code> function as follows.</p>

<div class="codehilite"><pre><span></span><code><span class="c1"># example.py</span>
<span class="kn">import</span> <span class="nn">run</span>

<span class="n">run</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;group_name_a&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;exp1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;exp2&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">run</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;group_name_b&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;exp3&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;exp4&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">run</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p>By running the script with a group name as parameter, all experiments
in that group are run, e.g., <code>python example.py group_name_a</code> runs
the experiments "exp1" and "exp2".</p>

<p>Experiment names are of course also blobs, so you can do the following
to create experiments with four different names in one group by
calling <code><a href="run.html#add">run.add()</a></code> just once.</p>

<div class="codehilite"><pre><span></span><code><span class="n">res_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;+&#39;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="s2">&quot;diff&quot;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="s2">&quot;prod&quot;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span> <span class="s2">&quot;quot&quot;</span><span class="p">}</span>
<span class="n">run</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;calculations&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;calculate_[[op_name]]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;echo $(([[a]] [[operator]] [[b]]))&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
     <span class="s1">&#39;operator&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">],</span>
     <span class="s1">&#39;op_name&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="n">res_name</span><span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;operator&#39;</span><span class="p">]]</span>
     <span class="p">},</span>
    <span class="n">stdout_file</span><span class="o">=</span><span class="s2">&quot;output/result_[[op_name]].txt&quot;</span><span class="p">,</span><span class="mi">1</span>
    <span class="n">stdout_res</span><span class="o">=</span><span class="s2">&quot;[[a]] [[operator]] [[b]] = [[stdout]]&quot;</span>
<span class="p">)</span>
</code></pre></div>

<p>Adding some more groups and calling <code>python example.py sum
sum_of_squares calculations</code> yields the following output.</p>

<p><img src="example_run_2.png" alt="Example Run 1" /></p>

<h2 id="parallelization">Parallelization</h2>

<p>Runs from the same experiment are run in parallel and you can choose
how many threads to use by calling <code><a href="run.html#use_cores">run.use_cores</a>(nr_cores)</code>.  By
default, <code>4</code> cores are used.</p>

<p><strong>Note:</strong> There is no parallelization between different experiments,
i.e., in the above example, all runs from <code>sum</code> have to finish
before the runs of <code>sum_of_squares</code> start.</p>

<p><strong>Note:</strong> Files are locked for writing, i.e., it is ok for multiple
runs of the same experiment to write to the same file.  It is also
made sure that the header is written only once.  If you abort an
experiment by interrupting it with <code>ctrl + c</code> there might be a
leftover <code>*.lock</code> file, which you have to remove manually.</p>

<h2 id="dry-run">Dry Run</h2>

<p>If you execute your experiment script with <code>dry_run</code> as parameter,
the runs are not executed.  Instead it is printed to <code>stdout</code> which
runs would have been called.</p>

<h2 id="creating-directories">Creating Directories</h2>

<p>If you use <code>stdout_file</code> and the directory where the output file
should be stored does not exist, it is created.</p>

<h2 id="multiple-runs-in-one-script">Multiple Runs in One Script</h2>

<p>You can call <code><a href="run.html#run">run.run()</a></code> multiple times in one script.  Each call
after the first considers only the runs added after the previous call.
This is useful when there are some experiments that create files and
then later experiments do something for each file created earlier.
This is demonstrated in the following example, where <code>create_files</code>
creates some <code>.txt</code> files while <code>copy_files</code> copies all <code>.txt</code>
files that are found by
<a href="https://docs.python.org/3/library/glob.html#glob.glob"><code>glob.glob("output/*.txt")</code></a>.</p>

<div class="codehilite"><pre><span></span><code><span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;create_files&quot;</span><span class="p">,</span>
    <span class="s2">&quot;touch [[file]]&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;</span><span class="p">},</span>
    <span class="n">creates_file</span><span class="o">=</span><span class="s2">&quot;[[file]]&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;output/*.txt&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;copy_files&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cp [[file]] [[copy]]&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">files</span><span class="p">,</span> <span class="s2">&quot;copy&quot;</span><span class="p">:</span> <span class="s2">&quot;[[file]].copy&quot;</span><span class="p">},</span>
    <span class="n">creates_file</span><span class="o">=</span><span class="s2">&quot;[[copy]]&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">run</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p>Without the first call to <code><a href="run.html#run">run.run()</a></code>,
<a href="https://docs.python.org/3/library/glob.html#glob.glob"><code>glob.glob()</code></a>
would not find the files created by <code>create_file</code> as they are not
yet created.  Thus, one would have to call the script twice to do both
experiments.  With the additional call to <code><a href="run.html#run">run.run()</a></code>, one can run
<code>create_files</code> and <code>copy_files</code> in one execution of the script.</p>

<h2 id="section-headlines">Section Headlines</h2>

<p>You can call <code><a href="run.html#section">run.section()</a></code> to print a section title (e.g., to
structure the output in case of multiple run calls).</p>

<h1 id="interface-documentationrunhtml"><a href="./run.html">Interface Documentation</a></h1>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">A module for running experiments that involve the execution of</span>
<span class="sd">commands with different combinations of command line arguments.</span>

<span class="sd">Read on for an explanation with a bunch of examples, check out the</span>
<span class="sd">[reference documentation](./run.html), or download the</span>
<span class="sd">[code](https://github.com/thobl/run).</span>

<span class="sd"># Basic Concepts</span>

<span class="sd">1. **Generate Argument Combinations.** Instead of specifying all</span>
<span class="sd">   combinations of command line arguments for your experiment</span>
<span class="sd">   explicitly, you specify the sets of values for each argument.  A</span>
<span class="sd">   set of runs with one run for each combination is generated</span>
<span class="sd">   automatically.</span>

<span class="sd">1. **Everything is a Blob.** At its core a blob is something that</span>
<span class="sd">   evaluates to a string based on the arguments of a single run.  In</span>
<span class="sd">   most cases, a blob is simply a string that can contain wildcards</span>
<span class="sd">   for these arguments.</span>

<span class="sd">1. **Skip Unnecessary Runs.** Runs are skipped if the produced output</span>
<span class="sd">   file already exists.  This is particularly helpful if the</span>
<span class="sd">   experiment setup evolves over time.</span>

<span class="sd">1. **Postprocessing the Output.** If the command prints its result to</span>
<span class="sd">   ``stdout``, you can specify how it should be saved to a file.  This</span>
<span class="sd">   lets you, e.g., add some reformatting procedure or handle timeouts.</span>

<span class="sd"># Usage</span>

<span class="sd">Your experiment script should look somewhat like this:</span>

<span class="sd">```python</span>
<span class="sd"># example.py</span>
<span class="sd">import run</span>

<span class="sd">run.add(...)</span>
<span class="sd">run.add(...)</span>
<span class="sd">...</span>
<span class="sd">run.run()</span>
<span class="sd">```</span>

<span class="sd">The method ``run.add()`` has three mandatory parameters and multiple</span>
<span class="sd">keyword parameters.  The first parameter specifies the name of the</span>
<span class="sd">experiment.  This is used so you can select which experiments to run,</span>
<span class="sd">e.g., calling ``python example.py name1 name2`` runs all experiments</span>
<span class="sd">where the name was ``name1`` or ``name2`` (experiments can also be</span>
<span class="sd">[grouped](#experiment-names-and-groups)).  The second parameter</span>
<span class="sd">specifies the command that should be called and the third parameter is</span>
<span class="sd">a description of the arguments the command should be called with.</span>
<span class="sd">Their usage is explained in the [next</span>
<span class="sd">section](#generate-argument-combinations).</span>

<span class="sd">## Generate Argument Combinations</span>

<span class="sd">Here is an easy example for an experiment that create some files by</span>
<span class="sd">calling the ``touch`` command.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;create_files&quot;,</span>
<span class="sd">    &quot;touch output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;,</span>
<span class="sd">    {&#39;a&#39;: [1, 2], &#39;b&#39;: [1, 2, 3], &#39;c&#39;: 0}</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">The third parameter specifies the three arguments ``a``, ``b``, and</span>
<span class="sd">``c``.  As ``a`` and ``b`` are lists, one run is created for each</span>
<span class="sd">combination of arguments.  The second parameter specifies the command</span>
<span class="sd">for each run.  It is a blob, i.e., the wildcard of the form ``[[a]]``</span>
<span class="sd">is replaced with the corresponding value for ``a`` in each of the</span>
<span class="sd">runs.  Thus, the above experiment calls ``touch`` six times creating</span>
<span class="sd">the following files.</span>

<span class="sd">```shell</span>
<span class="sd">$ ls output/</span>
<span class="sd">&#39;a=1_b=1_c=0.txt&#39;  &#39;a=1_b=2_c=0.txt&#39;  &#39;a=1_b=3_c=0.txt&#39;</span>
<span class="sd">&#39;a=2_b=1_c=0.txt&#39;  &#39;a=2_b=2_c=0.txt&#39;  &#39;a=2_b=3_c=0.txt&#39;</span>
<span class="sd">```</span>

<span class="sd">**Note:** In case your experiment involves some dependencies between</span>
<span class="sd">the parameters that make some of the combinations invalid, you can</span>
<span class="sd">[filter those out](#filtering-the-combinations).</span>

<span class="sd">## Everything is a Blob</span>

<span class="sd">In the above example, the command (second parameter) is a blob, i.e.,</span>
<span class="sd">all wildcards are replaced with the appropriate values for each run.</span>
<span class="sd">Besides being a string with wildcards, a blob can also be a function</span>
<span class="sd">that returns a string with wildcards.  In this case, it is called with</span>
<span class="sd">the arguments of the current run as parameter, before the wildcards</span>
<span class="sd">are replaced.  See [Blobs](#blobs) for more details.</span>

<span class="sd">Almost all parameters of `run.add()` are blobs and are thus evaluated</span>
<span class="sd">based on the arguments of each individual run.  Even the arguments</span>
<span class="sd">themselves can be blobs based on earlier arguments.  The [next</span>
<span class="sd">section](#skip-unnecessary-runs) contains an example for this.</span>
<span class="sd">Moreover, there are some more details on blobs [below](#blobs).</span>

<span class="sd">## Skip Unnecessary Runs</span>

<span class="sd">In the above example, ``run`` does not know that the runs create</span>
<span class="sd">files.  Thus, the ``touch`` commands is called even if the files</span>
<span class="sd">already exist.  You can use the optimal parameter ``creates_file`` to</span>
<span class="sd">explicitly state which file is created by a run.  It is a blob, so in</span>
<span class="sd">the above example you could add</span>
<span class="sd">``creats_file=&quot;output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;``.  Equivalently,</span>
<span class="sd">you can achieve the same in the following more elegant way, using that</span>
<span class="sd">the arguments themselves are blobs.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;create_files&quot;,</span>
<span class="sd">    &quot;touch [[file]]&quot;,</span>
<span class="sd">    {&#39;a&#39;: [1, 2], &#39;b&#39;: [1, 2, 3], &#39;c&#39;: 0,</span>
<span class="sd">     &#39;file&#39;: &quot;output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;},</span>
<span class="sd">    creates_file=&quot;[[file]]&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">Now executing the script calls ``touch`` only for those files that do</span>
<span class="sd">not already exist.  For more details on when exactly a run is skipped,</span>
<span class="sd">see [Policy of Skipping Runs](#policy-of-skipping-runs).</span>

<span class="sd">**Note:** Specifying ``creates_file`` is only necessary if the command</span>
<span class="sd">itself creates the file.  If instead the command&#39;s output to ``stdout``</span>
<span class="sd">is written to a file (see [next section](#postprocessing-the-output)),</span>
<span class="sd">``run`` already knows which file is created.</span>

<span class="sd">## Postprocessing the Output</span>

<span class="sd">If the parameter ``stdout_file`` is provided, the command&#39;s output to</span>
<span class="sd">``stdout`` is written to the corresponding file.  This is illustrated</span>
<span class="sd">by the following example.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;sum&quot;,</span>
<span class="sd">    &quot;echo $(([[a]] + [[b]]))&quot;,</span>
<span class="sd">    {&#39;a&#39;: [1, 2], &#39;b&#39;: [1, 2, 3]},</span>
<span class="sd">    stdout_file=&quot;output/[[a]]+[[b]].txt&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">The ``echo`` command itself adds the two given values and writes them</span>
<span class="sd">to standard output.  The run module takes this result and writes it</span>
<span class="sd">to the provided file instead.  Thus, executing this example creates</span>
<span class="sd">six files with different values for a and b, each of which contains</span>
<span class="sd">the sum of a and b as content.</span>

<span class="sd">You can postprocess ``stdout`` (given as string) by providing the</span>
<span class="sd">parameters ``stdout_mod`` (a function returning a blob) or</span>
<span class="sd">``stdout_res`` (a blob).  If both are provided, they are applied in</span>
<span class="sd">this order.</span>

<span class="sd">The function ``stdout_mod`` gets ``stdout`` as input its return value</span>
<span class="sd">replaces ``stdout``.  This can serve as some kind of parser that,</span>
<span class="sd">e.g., reformats the output from something human readable to csv.</span>
<span class="sd">Additionally, if the function takes two parameters, the second</span>
<span class="sd">parameter is the result of the call to</span>
<span class="sd">[``subprocess.run()``](https://docs.python.org/3/library/subprocess.html#subprocess.run).</span>
<span class="sd">This can be useful to do a more sophisticated reformatting not only</span>
<span class="sd">based on ``stdout`` but also, e.g., on the return code or stderr.</span>

<span class="sd">If the blob ``stdout_res`` is given, this blob is written to the file</span>
<span class="sd">instead of ``stdout`` itself.  This blob is somewhat special as it</span>
<span class="sd">allows for the additional argument ``stdout``.  The following example</span>
<span class="sd">uses ``stdout_res`` with the wildcard ``[[stdout]]``.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;sum&quot;,</span>
<span class="sd">    &quot;echo $(([[a]] + [[b]]))&quot;,</span>
<span class="sd">    {&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4]},</span>
<span class="sd">    stdout_file=&quot;output/sums.txt&quot;,</span>
<span class="sd">    stdout_res=&quot;[[a]] + [[b]] = [[stdout]]&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">This produces the following file.</span>

<span class="sd">``` shell</span>
<span class="sd">$ cat output/sums.txt </span>
<span class="sd">2 + 3 = 5</span>
<span class="sd">2 + 4 = 6</span>
<span class="sd">1 + 3 = 4</span>
<span class="sd">1 + 4 = 5</span>
<span class="sd">```</span>

<span class="sd">Note that the output of the individual runs was appended to the file,</span>
<span class="sd">i.e., the runs were not skipped.  This is the intended behavior to</span>
<span class="sd">support these kind of experiment setups; see [Policy of Skipping</span>
<span class="sd">Runs](#policy-of-skipping-runs) for more details on when exactly a run</span>
<span class="sd">is skipped.</span>

<span class="sd">**Note:** There are several cases where ``stdout_mod`` and</span>
<span class="sd">``stdout_res`` can both be used to achieve the same thing.  You can</span>
<span class="sd">use this rule of thumb:</span>

<span class="sd"> * Use ``stdout_mod`` if you want to reformat ``stdout`` or if you</span>
<span class="sd">   need access to things like the return code.</span>

<span class="sd"> * Use ``stdout_res`` if you want to combine ``stdout`` with the input</span>
<span class="sd">   arguments.</span>

<span class="sd"> * Use both if you need both.</span>
<span class="sd"> </span>
<span class="sd">**Note:** When using ``stdout_file``, one can additionally [write a</span>
<span class="sd">header](#headers) to the first line of the file.</span>

<span class="sd"># Details</span>

<span class="sd">When you execute your experiment script, the following steps are</span>
<span class="sd">performed in this order.</span>

<span class="sd">1. **Generate Combinations.** For each experiment, create the cross</span>
<span class="sd">   product of all argument lists provided in third parameter of</span>
<span class="sd">   ``run.add()``.  For each argument combination that is not rejected</span>
<span class="sd">   by [``combinations_filter``](#filtering-the-combinations), a single</span>
<span class="sd">   run is created.  Each individual argument is a blob.</span>

<span class="sd">1. **Deblob.** For each individual run, the [blobs are turned into</span>
<span class="sd">   strings](#blobs).  This is first done for all arguments in the</span>
<span class="sd">   order they are given.  Then all other blobs (except ``stdout_res``)</span>
<span class="sd">   are deblobbed.</span>

<span class="sd">1. **Skipping Runs.** For each run, it is decided whether to skip the</span>
<span class="sd">   run.  A run is skipped if the file it would produce (specified by</span>
<span class="sd">   ``creates_file`` or ``stdout_file``) already exists at this stage</span>
<span class="sd">   in the process.</span>

<span class="sd">1. **Filter Unselected Runs.** A run counts as selected if its</span>
<span class="sd">   experiments [name or group](#experiment-names-and-groups) was used</span>
<span class="sd">   as command line parameter to execute your experiment script.  All</span>
<span class="sd">   other runs are ignored.</span>
<span class="sd">   </span>
<span class="sd">1. **Run and Output Results.** The runs are executed and, depending on</span>
<span class="sd">   the [stdout settings](#postprocessing-the-output) and the [header</span>
<span class="sd">   settings](#headers), the output is written.</span>


<span class="sd">## Blobs</span>

<span class="sd">Deblobbing happens in three steps in the function ``run.deblob()``.</span>

<span class="sd">1. If the blob is a function, it is called with one parameter</span>
<span class="sd">   ``args``.  ``args`` is a dictionary mapping from the argument names</span>
<span class="sd">   to the value.  Note that this is done after generating the</span>
<span class="sd">   combinations, i.e., the argument values are no longer lists.</span>

<span class="sd">1. The result of step 1. (or the blob itself if it is not a function)</span>
<span class="sd">   is converted into a string.  Thus, it is ok for an argument to</span>
<span class="sd">   have, e.g., integer values or for the above function to return</span>
<span class="sd">   integer values.</span>

<span class="sd">1. In the resulting string, each pattern of the form ``[[key]]`` is</span>
<span class="sd">   replaced with the corresponding value in ``args``.</span>

<span class="sd">The following example is similar to one of the previous examples,</span>
<span class="sd">extending the computation of the sum to also compute differences,</span>
<span class="sd">products, and quotients.  It gives an example of how to make use of</span>
<span class="sd">the fact that blobs can be functions.  Note how the output file name</span>
<span class="sd">(``stdout_file``) of each run depends on the operator.  As the</span>
<span class="sd">argument combinations are generated before deblobbing,</span>
<span class="sd">``args[&#39;operator&#39;]`` in the lambda function evaluates to one of the</span>
<span class="sd">operators (and not to the list of all operators).  Running this,</span>
<span class="sd">creates the four files ``sum.txt``, ``diff.txt``, ``prod.txt``, and</span>
<span class="sd">``quot.txt``, each containing the respective calculations.</span>

<span class="sd">```python</span>
<span class="sd">res_name = {&#39;+&#39;: &quot;sum&quot;, &#39;-&#39;: &quot;diff&quot;, &#39;*&#39;: &quot;prod&quot;, &#39;/&#39;: &quot;quot&quot;}</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;calculate&quot;,</span>
<span class="sd">    &quot;echo $(([[a]] [[operator]] [[b]]))&quot;,</span>
<span class="sd">    {&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4],</span>
<span class="sd">     &#39;operator&#39;: [&quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;]</span>
<span class="sd">     },</span>
<span class="sd">    stdout_file=lambda args: &quot;output/&quot; + res_name[args[&#39;operator&#39;]] + &quot;.txt&quot;,</span>
<span class="sd">    stdout_res=&quot;[[a]] [[operator]] [[b]] = [[stdout]]&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">The next example highlights how the order of evaluation matters when</span>
<span class="sd">using blobs for the arguments.  Assume we have three arguments ``a``,</span>
<span class="sd">``b``, and ``c`` that depend on each other, i.e., we want to consider</span>
<span class="sd">not all but only certain combinations of values.  In this example, we</span>
<span class="sd">want ``a``, ``b``, and ``c`` to be all combinations of natural numbers</span>
<span class="sd">with ``a + b + c = 4``.  In the example below, this is done using the</span>
<span class="sd">helper argument ``triple``, which is a list of triples.  Then the</span>
<span class="sd">actual arguments ``a``, ``b``, and ``c`` use these triples.  Note that</span>
<span class="sd">blobs of ``a``, ``b``, and ``c`` are deblobbed (i.e., their lambda</span>
<span class="sd">functions are called) after lists have been split into separate runs</span>
<span class="sd">but before the ``triple`` argument was deblobbed.  Thus,</span>
<span class="sd">``args[&#39;triple&#39;]`` is a dictionary of the form ``{&#39;a&#39;: a, &#39;b&#39;: b, &#39;c&#39;:</span>
<span class="sd">c}``.  Moreover, ``a``, ``b``, and ``c`` are deblobbed before</span>
<span class="sd">``file``, which makes them usable as wildcards.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;sum_of_squares&quot;,</span>
<span class="sd">    &quot;echo $(([[a]] * [[a]] + [[b]] * [[b]] + [[c]] * [[c]]))&quot;,</span>
<span class="sd">    {&#39;a&#39;: lambda args: args[&#39;triple&#39;][&#39;a&#39;],</span>
<span class="sd">     &#39;b&#39;: lambda args: args[&#39;triple&#39;][&#39;b&#39;],</span>
<span class="sd">     &#39;c&#39;: lambda args: args[&#39;triple&#39;][&#39;c&#39;],</span>
<span class="sd">     &#39;triple&#39;: [{&#39;a&#39;: a, &#39;b&#39;: b, &#39;c&#39;: c}</span>
<span class="sd">                for a in range(0, 5) for b in range(0, 5) for c in range(0, 5)</span>
<span class="sd">                if a + b + c == 4],</span>
<span class="sd">     &#39;file&#39;: &quot;output/sum_of_squares_[[a]]_[[b]]_[[c]].txt&quot;</span>
<span class="sd">     },</span>
<span class="sd">    stdout_file=&quot;[[file]]&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">Changing the order could have unwanted effects.  Moving the argument</span>
<span class="sd">``triple`` before ``a`` would first deblob ``triple``, before calling</span>
<span class="sd">the lambda function, which means that ``args[&#39;triple&#39;]`` would be the</span>
<span class="sd">string representation of the dictionary instead of the dictionary</span>
<span class="sd">itself.  Moreover, having ``file`` before ``a`` would make the use of</span>
<span class="sd">``&#39;[[a]]&#39;`` invalid, as the argument ``a`` would not be a string but a</span>
<span class="sd">function when trying to do the replacement.</span>

<span class="sd">As a rule of thumb: Arguments you use as wild cards should go before,</span>
<span class="sd">arguments you want to use in their original form (not in their string</span>
<span class="sd">representation) within a function should go after.</span>

<span class="sd">**Note:** In the above example one could of course remove the ``file``</span>
<span class="sd">argument and directly assign its blob to ``stdout_file``, as the</span>
<span class="sd">arguments are always deblobbed before any other blobs (like</span>
<span class="sd">``stdout_file``).</span>

<span class="sd">## Filtering the Combinations</span>

<span class="sd">The previous example showed a somewhat hacky way of only looking at</span>
<span class="sd">those combinations of arguments ``a``, ``b``, and ``c`` where ``a +</span>
<span class="sd">b + c = 4``.  This can be achieved much easier using the parameter</span>
<span class="sd">``combinations_filter``.  It is a function that gets called for every</span>
<span class="sd">argument combination and decides whether it is valid (in which case a</span>
<span class="sd">run is created) or not (in which case the combination is discarded).</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;better_sum_of_squares&quot;,</span>
<span class="sd">    &quot;echo $(([[a]] * [[a]] + [[b]] * [[b]] + [[c]] * [[c]]))&quot;,</span>
<span class="sd">    {&#39;a&#39;: list(range(0, 5)), &#39;b&#39;: list(range(0, 5)), &#39;c&#39;: list(range(0, 5))},</span>
<span class="sd">    stdout_file=&quot;output/sum_of_squares_[[a]]_[[b]]_[[c]]_good.txt&quot;,</span>
<span class="sd">    combinations_filter=lambda args: args[&#39;a&#39;] + args[&#39;b&#39;] + args[&#39;c&#39;] == 4</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">## Policy of Skipping Runs</span>

<span class="sd">From the [order of steps](#details) discussed above, it becomes</span>
<span class="sd">implicitly clear that runs are only skipped if the result files</span>
<span class="sd">already exist at the time the script is executed.  Thus, if two runs</span>
<span class="sd">have the same non-existent output file, they are both run, even if the</span>
<span class="sd">file exists when the second run starts.  To make this more explicit,</span>
<span class="sd">here is the behavior of writing files when using the ``stdout_file``</span>
<span class="sd">parameter.</span>

<span class="sd">1. If the file exists when adding the experiment via ``run.add()``</span>
<span class="sd">   (i.e., before running any experiment), then the run is skipped.</span>

<span class="sd">1. If the run is not skipped but the file exists when executing the</span>
<span class="sd">   run, ``stdout`` is added at the end of the file.</span>

<span class="sd">1. If the file does not exist, it is created beginning with the</span>
<span class="sd">   [header](#headers) (if specified) and then ``stdout`` is added.</span>
<span class="sd">   </span>
<span class="sd">Thus, instead of writing one file per run, one can also have multiple</span>
<span class="sd">runs write their output into a single file.  This can be the intended</span>
<span class="sd">behavior if, e.g., the output of the same algorithm on multiple</span>
<span class="sd">instances should appear in the same csv file.  The disadvantage of</span>
<span class="sd">this is that either all or none of the experiments creating this file</span>
<span class="sd">are skipped, so extending the experiment would require to rerun it</span>
<span class="sd">(which might be ok, depending on your use case).</span>
<span class="sd">			   </span>
<span class="sd">## Headers</span>

<span class="sd">When using ``stdout_file``, one can use the parameter</span>
<span class="sd">``header_string`` (a blob) to specify a header that should appear in</span>
<span class="sd">the first line of the file.  Alternatively, one can specify</span>
<span class="sd">``header_command`` (again, a blob), which is a command that is</span>
<span class="sd">executed and its output (to ``stdout``) is used as header.  The</span>
<span class="sd">resulting header can be modified by specifying the parameter</span>
<span class="sd">``header_mod``.  It should be a function that takes the unmodified</span>
<span class="sd">header as input and outputs the actual (modified) header.</span>

<span class="sd">Using ``header_command`` instead of simply ``header_string`` is</span>
<span class="sd">advantageous in the following scenario.  Assume you have an executable</span>
<span class="sd">called ``algo`` that runs a certain algorithm on an input file and</span>
<span class="sd">outputs some statistics using comma-separated values.  Moreover,</span>
<span class="sd">assume ``algo`` is capable of printing the corresponding header by</span>
<span class="sd">calling ``algo --only-header``.  Then the following example first</span>
<span class="sd">writes the header (obtained by calling ``algo --only-header``)</span>
<span class="sd">followed by the results of running ``algo`` on three input files.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;algo&quot;,</span>
<span class="sd">    &quot;algo [[input]]&quot;,</span>
<span class="sd">    {&#39;input&#39;: [&quot;file1&quot;, &quot;file2&quot;, &quot;file3&quot;]},</span>
<span class="sd">    stdout_file=&quot;output.csv&quot;,</span>
<span class="sd">    header_command=&quot;algo --only-header&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">The advantage of this is that the knowledge about the output of</span>
<span class="sd">``algo`` is concentrated at the ``algo`` executable, i.e., the</span>
<span class="sd">experiment script does not have to change if the statistics printed by</span>
<span class="sd">``algo`` change.  Moreover, using ``header_command`` over</span>
<span class="sd">``header_string`` becomes even more advantageous, when running</span>
<span class="sd">multiple commands, e.g., ``algo1`` and ``algo2``, with the same</span>
<span class="sd">command line interface (but potentially very different outputs) on the</span>
<span class="sd">same set of files.  This is illustrated by the following example (note</span>
<span class="sd">the usage of the wildcard ``[[algo]]`` in the command (second</span>
<span class="sd">parameter) and the ``header_command``).</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;algos&quot;,</span>
<span class="sd">    &quot;[[algo]] [[input]]&quot;,</span>
<span class="sd">    {&#39;algo&#39;: [&quot;algo1&quot;, &quot;algo2&quot;],</span>
<span class="sd">     &#39;input&#39;: [&quot;file1&quot;, &quot;file2&quot;, &quot;file3&quot;]},</span>
<span class="sd">    stdout_file=&quot;output_[[algo]].csv&quot;,</span>
<span class="sd">    header_command=&quot;[[algo]] --only-header&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">## Error Handling</span>

<span class="sd">This section is only about errors that happen when executing a run.</span>
<span class="sd">If you have an error in your experiment specification, then you</span>
<span class="sd">probably just get a python error you have to deal with.</span>

<span class="sd">You can specify the allowed return codes of an experiment via the</span>
<span class="sd">parameter ``allowed_return_codes``.  The default is ``[0]``.  If the</span>
<span class="sd">return code of the command is not in the list of allowed return codes,</span>
<span class="sd">a warning is printed and the run is aborted, meaning that ``stdout``</span>
<span class="sd">is **not** written to the file given by ``stdout_file``.  You can set</span>
<span class="sd">``allowed_return_codes`` to ``[]`` to indicate that every return code</span>
<span class="sd">should be accepted (you probably should not do this).</span>

<span class="sd">In case different return codes are possible, you probably want to</span>
<span class="sd">postprocess the result by using ``stdout_mod`` or ``stdout_res``.</span>
<span class="sd">With the former, you have access to the return code; with the latter</span>
<span class="sd">you only have the output of the command; see the section about</span>
<span class="sd">[postprocessing the standard output](#postprocessing-the-output).</span>

<span class="sd">In the following example, ``sleep [[time]] &amp;&amp; echo waking up`` waits</span>
<span class="sd">for 0 to 4 seconds and then outputs ``waking up``.  The command</span>
<span class="sd">``timeout 2`` aborts this after 2 seconds and returns with code</span>
<span class="sd">``124`` and no output to ``stdout``.  The return codes ``0`` and</span>
<span class="sd">``124`` are allowed by setting ``allowed_return_codes=[0, 124]``.</span>
<span class="sd">Moreover, the blob ``stdout_res`` specifies the output depending on</span>
<span class="sd">whether there was a timeout.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;timeouts&quot;,</span>
<span class="sd">    &quot;timeout 2 sleep [[time]] &amp;&amp; echo waking up&quot;,</span>
<span class="sd">    {&#39;time&#39;: [0, 1, 2, 3, 4]},</span>
<span class="sd">    stdout_file=&quot;output/timeouts.txt&quot;,</span>
<span class="sd">    allowed_return_codes=[0, 124],</span>
<span class="sd">    stdout_res=lambda args: (</span>
<span class="sd">        &quot;sleeping [[time]]s -&gt; [[stdout]]&quot; if args[&#39;stdout&#39;] != &quot;&quot; else</span>
<span class="sd">        &quot;sleeping [[time]]s -&gt; timeout&quot;)</span>
<span class="sd">)</span>
<span class="sd">```</span>
<span class="sd">This produces the following file.</span>

<span class="sd">```shell</span>
<span class="sd">$ cat output/timeouts.txt </span>
<span class="sd">sleeping 0s -&gt; waking up</span>
<span class="sd">sleeping 1s -&gt; waking up</span>
<span class="sd">sleeping 3s -&gt; timeout</span>
<span class="sd">sleeping 4s -&gt; timeout</span>
<span class="sd">sleeping 2s -&gt; timeout</span>
<span class="sd">```</span>

<span class="sd">The above example relies on the fact that the standard output is the</span>
<span class="sd">empty string in case of an error.  The following yields the same</span>
<span class="sd">result but explicitly checks for the return code using ``stdout_mod``</span>
<span class="sd">instead of ``stdout_res``.</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;timeouts&quot;,</span>
<span class="sd">    &quot;timeout 2 sleep [[time]] &amp;&amp; echo waking up&quot;,</span>
<span class="sd">    {&quot;time&quot;: [0, 1, 2, 3, 4]},</span>
<span class="sd">    stdout_file=&quot;output/timeouts.txt&quot;,</span>
<span class="sd">    allowed_return_codes=[0, 124],</span>
<span class="sd">    stdout_mod=lambda out, res: (</span>
<span class="sd">        &quot;sleeping [[time]]s -&gt; [[stdout]]&quot;</span>
<span class="sd">        if res.returncode == 0</span>
<span class="sd">        else &quot;sleeping [[time]]s -&gt; timeout&quot;</span>
<span class="sd">    ),</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">In the above example, one could also use the parameter ``out``</span>
<span class="sd">directly instead of using the wildcard ``[[stdout]]``.</span>

<span class="sd"># Miscellaneous Features</span>

<span class="sd">There are some features that are not at the core of `run` in the sense</span>
<span class="sd">that they are independent of how you specify your experiments.</span>
<span class="sd">Nonetheless they are pretty useful and should be mentioned here.</span>

<span class="sd">## Experiment Names and Groups</span>

<span class="sd">When running the experiment script with all examples from above by</span>
<span class="sd">calling ``python example.py create_files calculate``, the output looks</span>
<span class="sd">somewhat like this:</span>

<span class="sd">![Example Run 1](example_run_1.png)</span>

<span class="sd">You can see that a bunch of experiments are available.  The two</span>
<span class="sd">selected ones are highlighted in green (here ``create_files `` and</span>
<span class="sd">``calculate``), all others are red.</span>

<span class="sd">To select which experiments to run more conveniently, you can group</span>
<span class="sd">experiments using the ``run.group()`` function as follows.</span>

<span class="sd">```python</span>
<span class="sd"># example.py</span>
<span class="sd">import run</span>

<span class="sd">run.group(&quot;group_name_a&quot;)</span>
<span class="sd">run.add(&quot;exp1&quot;, ...)</span>
<span class="sd">run.add(&quot;exp2&quot;, ...)</span>
<span class="sd">...</span>
<span class="sd">run.group(&quot;group_name_b&quot;)</span>
<span class="sd">run.add(&quot;exp3&quot;, ...)</span>
<span class="sd">run.add(&quot;exp4&quot;, ...)</span>
<span class="sd">...</span>
<span class="sd">run.run()</span>
<span class="sd">```</span>

<span class="sd">By running the script with a group name as parameter, all experiments</span>
<span class="sd">in that group are run, e.g., ``python example.py group_name_a`` runs</span>
<span class="sd">the experiments &quot;exp1&quot; and &quot;exp2&quot;.</span>

<span class="sd">Experiment names are of course also blobs, so you can do the following</span>
<span class="sd">to create experiments with four different names in one group by</span>
<span class="sd">calling ``run.add()`` just once.</span>

<span class="sd">```python</span>
<span class="sd">res_name = {&#39;+&#39;: &quot;sum&quot;, &#39;-&#39;: &quot;diff&quot;, &#39;*&#39;: &quot;prod&quot;, &#39;/&#39;: &quot;quot&quot;}</span>
<span class="sd">run.group(&quot;calculations&quot;)</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;calculate_[[op_name]]&quot;,</span>
<span class="sd">    &quot;echo $(([[a]] [[operator]] [[b]]))&quot;,</span>
<span class="sd">    {&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4],</span>
<span class="sd">     &#39;operator&#39;: [&quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;],</span>
<span class="sd">     &#39;op_name&#39;: lambda args: res_name[args[&#39;operator&#39;]]</span>
<span class="sd">     },</span>
<span class="sd">    stdout_file=&quot;output/result_[[op_name]].txt&quot;,1</span>
<span class="sd">    stdout_res=&quot;[[a]] [[operator]] [[b]] = [[stdout]]&quot;</span>
<span class="sd">)</span>
<span class="sd">```</span>

<span class="sd">Adding some more groups and calling ``python example.py sum</span>
<span class="sd">sum_of_squares calculations`` yields the following output.</span>

<span class="sd">![Example Run 1](example_run_2.png)</span>

<span class="sd">## Parallelization</span>

<span class="sd">Runs from the same experiment are run in parallel and you can choose</span>
<span class="sd">how many threads to use by calling ``run.use_cores(nr_cores)``.  By</span>
<span class="sd">default, ``4`` cores are used.</span>

<span class="sd">**Note:** There is no parallelization between different experiments,</span>
<span class="sd">i.e., in the above example, all runs from ``sum`` have to finish</span>
<span class="sd">before the runs of ``sum_of_squares`` start.</span>

<span class="sd">**Note:** Files are locked for writing, i.e., it is ok for multiple</span>
<span class="sd">runs of the same experiment to write to the same file.  It is also</span>
<span class="sd">made sure that the header is written only once.  If you abort an</span>
<span class="sd">experiment by interrupting it with ``ctrl + c`` there might be a</span>
<span class="sd">leftover ``*.lock`` file, which you have to remove manually.</span>

<span class="sd">## Dry Run</span>

<span class="sd">If you execute your experiment script with ``dry_run`` as parameter,</span>
<span class="sd">the runs are not executed.  Instead it is printed to ``stdout`` which</span>
<span class="sd">runs would have been called.</span>

<span class="sd">## Creating Directories</span>

<span class="sd">If you use ``stdout_file`` and the directory where the output file</span>
<span class="sd">should be stored does not exist, it is created.</span>

<span class="sd">## Multiple Runs in One Script</span>

<span class="sd">You can call ``run.run()`` multiple times in one script.  Each call</span>
<span class="sd">after the first considers only the runs added after the previous call.</span>
<span class="sd">This is useful when there are some experiments that create files and</span>
<span class="sd">then later experiments do something for each file created earlier.</span>
<span class="sd">This is demonstrated in the following example, where ``create_files``</span>
<span class="sd">creates some ``.txt`` files while ``copy_files`` copies all ``.txt``</span>
<span class="sd">files that are found by</span>
<span class="sd">[``glob.glob(&quot;output/*.txt&quot;)``](https://docs.python.org/3/library/glob.html#glob.glob).</span>

<span class="sd">```python</span>
<span class="sd">run.add(</span>
<span class="sd">    &quot;create_files&quot;,</span>
<span class="sd">    &quot;touch [[file]]&quot;,</span>
<span class="sd">    {&quot;a&quot;: [1, 2], &quot;b&quot;: [1, 2, 3], &quot;c&quot;: 0, &quot;file&quot;: &quot;output/a=[[a]]_b=[[b]]_c=[[c]].txt&quot;},</span>
<span class="sd">    creates_file=&quot;[[file]]&quot;,</span>
<span class="sd">)</span>
<span class="sd">run.run()</span>

<span class="sd">import glob</span>
<span class="sd">files = glob.glob(&quot;output/*.txt&quot;)</span>

<span class="sd">run.add(</span>
<span class="sd">    &quot;copy_files&quot;,</span>
<span class="sd">    &quot;cp [[file]] [[copy]]&quot;,</span>
<span class="sd">    {&quot;file&quot;: files, &quot;copy&quot;: &quot;[[file]].copy&quot;},</span>
<span class="sd">    creates_file=&quot;[[copy]]&quot;,</span>
<span class="sd">)</span>
<span class="sd">run.run()</span>
<span class="sd">```</span>

<span class="sd">Without the first call to ``run.run()``,</span>
<span class="sd">[``glob.glob()``](https://docs.python.org/3/library/glob.html#glob.glob)</span>
<span class="sd">would not find the files created by ``create_file`` as they are not</span>
<span class="sd">yet created.  Thus, one would have to call the script twice to do both</span>
<span class="sd">experiments.  With the additional call to ``run.run()``, one can run</span>
<span class="sd">``create_files`` and ``copy_files`` in one execution of the script.</span>

<span class="sd">## Section Headlines</span>

<span class="sd">You can call ``run.section()`` to print a section title (e.g., to</span>
<span class="sd">structure the output in case of multiple run calls).</span>

<span class="sd"># [Interface Documentation](./run.html)</span>

<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

        </details>

            </section>
    </main>
</body>
</html>